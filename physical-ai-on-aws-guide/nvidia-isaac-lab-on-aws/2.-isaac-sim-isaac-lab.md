---
description: Isaac Sim GUI 렌더링 확인 및 Isaac Lab을 이용한 RL 수행
metaLinks:
  alternates:
    - >-
      https://app.gitbook.com/s/eiiMMZMGOJGOQZP7MGcd/physical-ai-on-aws-guide/nvidia-isaac-lab-on-aws/2.-isaac-sim-isaac-lab
---

# 2. Isaac Sim / Isaac Lab 환경 확인

### 1. 배포된 EC2 환경 접속

<figure><img src="../../.gitbook/assets/image (5).png" alt=""><figcaption></figcaption></figure>

`DCVURL` 주소로 들어가면 위와 같이 DCV 로그인 화면이 나옵니다.

> [Amazon DCV (Desktop Cloud Visualization)](https://docs.aws.amazon.com/ko_kr/dcv/latest/adminguide/what-is-dcv.html)는 AWS가 제공하는 고성능 원격 디스플레이 프로토콜입니다. Amazon EC2와 함께 사용하면 그래픽 집약적 애플리케이션을 Amazon EC2 인스턴스에서 원격으로 실행할 수 있습니다. 복잡한 로봇 시뮬레이션과 물리 엔진을 실시간으로 렌더링 하기 위해 사용합니다.

로그인 정보는 AWS Console의 AWS Secrets Manager에서 확인할 수 있습니다.

<figure><img src="../../.gitbook/assets/image (6).png" alt=""><figcaption></figcaption></figure>

AWS Secrets Manager - `InstanceCredentials-*` - `Retrieve Secret` 선택하면, username과 password를 확인할 수 있습니다.

해당 정보를 사용하여 DCV 세션으로 로그인 하면 Amazon EC2 DCV 인스턴스에서 실행되는 Amazon DCV 원격 디스플레이가 열립니다.

<figure><img src="../../.gitbook/assets/image (8).png" alt=""><figcaption></figcaption></figure>

Deep Learning AMI를 사용해 인스턴스를 생성했기 때문에 CUDA, Nvidia Driver, PyTorch 등 기본적인 학습을 위항 환경 설정이 되어 있습니다.

<figure><img src="../../.gitbook/assets/image (7).png" alt=""><figcaption></figcaption></figure>

```bash
cd ~/environment/IsaacLab
cat Dockerfile
```

IssacLab 실행을 위한 파일들과 Dockerfile을 확인 할 수 있습니다.

Dockerfile에는 아래와 같은 항목이 포함되어 있습니다:

* NVIDIA Isaac Sim 5.0 이미지 다운로드
* IssacLab 워크스페이스 추가
* 다중 노드 및 다중 GPU 환경에서 Isaac Lab RL 작업을 실행하는데에 필요한 스크립트 (`distributed_run.bash`)

<details>

<summary><mark style="color:$danger;"><strong>[Trobleshooting]</strong></mark> 'isaacsim.asset.importer.urdf' = { version='=2.4.31' }</summary>

```shellscript
2026-01-31T14:17:56Z [3,638ms] [Error] [omni.ext.plugin] Failed to resolve extension dependencies. Failure hints:
	[isaaclab.python-2.3.2] dependency: 'isaacsim.asset.importer.urdf' = { version='=2.4.31' } can't be satisfied. Available versions:
	 - [isaacsim.asset.importer.urdf-2.4.19+107.3.1.lx64.r.cp311] (/isaac-sim/exts/isaacsim.asset.importer.urdf)
	 - [isaacsim.asset.importer.urdf-2.4.12+107.3.0.lx64.r.cp311] (registry)
 Platform incompatible packages:
	 - [isaacsim.asset.importer.urdf-2.4.31+109.0.1.wx64.r.cp312] (registry)
	 - [isaacsim.asset.importer.urdf-2.4.31+107.3.3.lx64.d.cp311] (registry)
	 - [isaacsim.asset.importer.urdf-2.4.31+107.3.3.lx64.r.cp311] (registry)
	 - [isaacsim.asset.importer.urdf-2.4.31+109.0.1.la64.d.cp312] (registry)
	 - [isaacsim.asset.importer.urdf-2.4.31+109.0.1.lx64.r.cp312] (registry)
	 - [isaacsim.asset.importer.urdf-2.4.31+109.0.1.la64.r.cp312] (registry)
	 - [isaacsim.asset.importer.urdf-2.4.31+109.0.0.wx64.r.cp312] (registry)
	 - [isaacsim.asset.importer.urdf-2.4.31+109.0.0.la64.d.cp312] (registry)
	 - [isaacsim.asset.importer.urdf-2.4.31+109.0.0.lx64.d.cp312] (registry)
	 - [isaacsim.asset.importer.urdf-2.4.31+107.3.3.wx64.d.cp311] (registry)
	 - ... (8 more) ...
 Synced registries:
	 - kit/default         : found 1282 packages 
	 - kit/sdk             : found 342 packages 
	 - kit/community       : found 498 packages 

2026-01-31T14:17:56Z [3,639ms] [Error] [omni.kit.app.plugin] Exiting app because of dependency solver failure...
```

Dockerfile에서 Isaac Sim 5.0.0을 설치했는데, Isaac Lab에서 Isaac Sim 4.5.0 (URDF 2.4.31 포함)의 기능을 가져오려고 해서 에러가 발생합니다.

최신 Isaac Lab(v2.3.2 이상)은 Isaac Sim 4.5.0을 표준으로 지원하고 있어, 최신 버전의 Isaac Sim의 일부 기능에서 호환성 문제가 발생할 수 있습니다.

이 문제를 해결하기 위해 Dockerfile에서 Isaac Sim 컨테이너 이미지를 변경합니다.

`FROM nvcr.io/nvidia/isaac-sim:5.0.0` -> **`FROM nvcr.io/nvidia/isaac-sim:4.5.0`**

Dockerfile을 변경한 후에는 새로 Docker 빌드가 필요합니다.

```bash
docker build -t isaaclab-batch:latest . --no-cahe
```

</details>

<details>

<summary><mark style="color:$info;">[Info]</mark> EC2의 UserData에서 IsaacLab 세팅을 위해 수행된 동작</summary>

```
### 4. ROS
wget <https://raw.githubusercontent.com/aws-samples/robotics-boilerplate/main/install-ros.sh>
bash ./install-ros.sh

### 5. INSTALL DOCKER
wget <https://raw.githubusercontent.com/aws-samples/robotics-boilerplate/main/install-docker.sh>
bash ./install-docker.sh

### 5. SIMULATORS
wget <https://raw.githubusercontent.com/aws-samples/robotics-boilerplate/main/install-simulators.sh>
bash ./install-simulators.sh

### 8. NVIDIA Package Installation
apt-get install -y nvidia-driver-535-server
curl -fsSL <https://nvidia.github.io/libnvidia-container/gpgkey> | sudo gpg --dearmor -o /usr/share/keyrings/nvidia-container-toolkit-keyring.gpg \\
&& curl -s -L <https://nvidia.github.io/libnvidia-container/stable/deb/nvidia-container-toolkit.list> | \\
    sed 's#deb https://#deb [signed-by=/usr/share/keyrings/nvidia-container-toolkit-keyring.gpg] https://#g' | \\
    sudo tee /etc/apt/sources.list.d/nvidia-container-toolkit.list \\
&& \\
    sudo apt-get update
apt-get install -y nvidia-container-toolkit nfs-common
systemctl restart docker
docker run --rm --gpus all ubuntu nvidia-smi

### 9. EFS Mounting
mkdir -p /home/ubuntu/environment/efs
chown -R ubuntu:ubuntu /home/ubuntu/environment/efs
mount -t nfs4 -o nfsvers=4.1,rsize=1048576,wsize=1048576,hard,timeo=600,retrans=2 ${FileSystem}.efs.${AWS::Region}.amazonaws.com:/ /home/ubuntu/environment/efs
wget -P /home/ubuntu/environment/efs <https://ws-assets-prod-iad-r-pdx-f3b3f9f1a7d6a3d0.s3.us-west-2.amazonaws.com/075ce3fe-6888-4ea9-986e-5bdd1b767ef7/agent_72000.pt>

### 11 NVIDIA Isaac Lab Installation
cd /home/ubuntu/environment
git clone <https://github.com/isaac-sim/IsaacLab.git>
chown -R ubuntu:ubuntu /home/ubuntu/environment/IsaacLab
cd /home/ubuntu/environment/IsaacLab
wget <https://ws-assets-prod-iad-r-pdx-f3b3f9f1a7d6a3d0.s3.us-west-2.amazonaws.com/075ce3fe-6888-4ea9-986e-5bdd1b767ef7/Dockerfile>
wget <https://ws-assets-prod-iad-r-pdx-f3b3f9f1a7d6a3d0.s3.us-west-2.amazonaws.com/075ce3fe-6888-4ea9-986e-5bdd1b767ef7/distributed_run.bash>
docker build -t isaaclab-batch:latest .
aws ecr create-repository --repository-name isaaclab-batch --region ${AWS::Region}
aws ecr get-login-password --region ${AWS::Region} | docker login --username AWS --password-stdin ${AWS::AccountId}.dkr.ecr.${AWS::Region}.amazonaws.com
docker tag isaaclab-batch:latest ${AWS::AccountId}.dkr.ecr.${AWS::Region}.amazonaws.com/isaaclab-batch:latest
docker push ${AWS::AccountId}.dkr.ecr.${AWS::Region}.amazonaws.com/isaaclab-batch:latest
```

</details>

***

### 2. Isaac Lab으로 휴머노이드 강화 학습 실행

아래 명령어를 사용해 Isaac Sim 도커 컨테이너를 실행합니다.

```bash
cd environment/IsaacLab
xhost +
# Dockerfile을 수정한 경우 아래 주석 해제
# docker build -t isaaclab-batch:latest . --no-cache

docker run --shm-size=60g --name isaac-lab \
    --entrypoint bash -it --gpus all -e "ACCEPT_EULA=Y" --rm --network=host \
    -e DISPLAY \
    -e "PRIVACY_CONSENT=Y" \
    isaaclab-batch:latest
```

컨테이너가 실행되면, 컨테이너 내부 프롬프트에서 다음 명령어를 사용해 학습 작업을 실행합니다.

```shellscript
/isaac-sim/python.sh \
    -m torch.distributed.run \
    --nnodes=1 \
    --nproc_per_node=1 \
    scripts/reinforcement_learning/skrl/train.py \
    --task=Isaac-Velocity-Rough-H1-v0
```

* 강화학습 라이브러리인 skrl를 활용해 학습 ([scripts/reinforcement\_learning/skrl/train.py](https://github.com/isaac-sim/IsaacLab/blob/main/scripts/reinforcement_learning/skrl/train.py))
* 학습할 Task ([사용 가능한 task 목록](https://isaac-sim.github.io/IsaacLab/main/source/overview/environments.html))

`"Issac Sim" is not responding` 경고창이 나오더라도 `Wait` 버튼을 누르고 대기하세요. Issac Sim GUI가 로딩되고 학습이 시작되는데 5분 미만으로 시간이 소요됩니다.

<figure><img src="../../.gitbook/assets/image (13).png" alt=""><figcaption></figcaption></figure>

학습이 진행되는 동안 Tensorboard를 통해 학습 과정을 확인할 수 있습니다.

```shellscript
docker exec -it isaac-lab bash

cd /workspace/IsaacLab
/isaac-sim/python.sh -m tensorboard.main --logdir logs/skrl/h1_rough/
```

`http://localhost:6006` 에 접속해서 텐서보드를 확인할 수 있습니다.

<figure><img src="../../.gitbook/assets/image (12).png" alt=""><figcaption></figcaption></figure>

* **mean\_episode\_length**: 모든 에이전트에 대해 환경에서 각 에피소드의 평균 길이입니다. 이는 환경이 재설정되기 전에 거치는 반복 횟수를 정의합니다. 최적의 경우, 학습이 끝날 때쯤에는 에피소드 길이가 최대값에 도달해야 합니다.
* **mean\_reward**: 각 iteration에서 학습이 어떻게 수행되고 있는지를 나타냅니다.

{% hint style="info" %}
실제 휴머노이드 Policy은 이 환경을 활용하여 72,000회 이상의 학습 epoch와 3시간 동안 복잡한 이족 보행 작업을 학습합니다. 학습이 완료될 때까지 기다릴 필요 없이 다음 단계로 진행하세요.
{% endhint %}

***

### References

{% embed url="https://isaac-sim.github.io/IsaacLab/main/index.html" %}

{% embed url="https://catalog.ngc.nvidia.com/orgs/nvidia/containers/isaac-sim" %}
