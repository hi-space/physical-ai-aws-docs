---
description: IsaacSim 환경에 학습이 완료된 모델 로드
---

# 4. IsaacSim에서 학습된 모델 로드

학습이 완료된 휴머노이드 모델을 [EFS (Elastic File System)](https://docs.aws.amazon.com/ko_kr/efs/latest/ug/whatisefs.html) 폴더에 저장해놨습니다. 이 폴더를 DCV EC2 인스턴스에 마운트하여 IsaacSim에서 실행할 수 있습니다.&#x20;

### 1. EFS 마운트

Elastic File System 콘솔에 접속하여 IsaacLab을 선택하고 파일 시스템 ID를 복사하세요.&#x20;

<figure><img src="../../.gitbook/assets/image (31).png" alt=""><figcaption></figcaption></figure>

복사한 파일 시스템 ID를 아래 명령에서 `<File System ID>` 에 붙여넣으세요.&#x20;

```bash
sudo mount -t nfs4 -o nfsvers=4.1,rsize=1048576,wsize=1048576,hard,timeo=600,retrans=2,noresvport <File System ID>.efs.us-east-1.amazonaws.com:/ /home/ubuntu/environment/efs
```

### 2. Docker 컨테이너 실행

EFS가 마운트된 Docker 컨테이너를 실행합니다.

```bash
cd ~/environment/IsaacLab
xhost +
docker run --shm-size=60g --name isaac-lab \
    --entrypoint bash -it \
    --gpus all -e "ACCEPT_EULA=Y" --rm --network=host \
    -v /home/ubuntu/environment/efs:/workspace/IsaacLab/TrainedModel \
    -e DISPLAY \
    -e "PRIVACY_CONSENT=Y" \
    isaaclab-batch:latest
```

`-v /home/ubuntu/environment/efs:/workspace/IsaacLab/TrainedModel` 명렁어를 통해 호스트 컴퓨터의 EFS 폴더를 컨테이너 내부의 `TrainedModel` 폴더와 마운트합니다.&#x20;

즉, 마운트된 EFS 디렉터리가 컨테이너 내부의 /workspace/IsaacLab/TrainedModel 디렉토리에서 사용 가능해집니다.

```bash
cd /workspace/IsaacLab/TrainedModel
ls -lrt 
```

EFS 디렉토리로 이동하여 학습된 모델을 확인할 수 있습니다.

<figure><img src="../../.gitbook/assets/image (32).png" alt=""><figcaption></figcaption></figure>

***

### 3. 학습이 완료된 모델로 IsaacSim 실행 (사전 학습 완료 모델 검증)

EFS에 저장된 학습된 모델을 사용하여 테스트 모드로 실행합니다.

```shellscript
cd /workspace/IsaacLab
./isaaclab.sh -p scripts/reinforcement_learning/skrl/play.py \
    --task=Isaac-Velocity-Rough-H1-v0 \
    --num_envs 25 \
    --checkpoint=/workspace/IsaacLab/TrainedModel/agent_72000.pt
```

<figure><img src="../../.gitbook/assets/image (36).png" alt=""><figcaption></figcaption></figure>

```bash
cd /workspace/IsaacLab
/isaac-sim/python.sh scripts/demos/h1_locomotion.py
```

시뮬레이션 환경이 완전히 로드되면 휴머노이드 로봇을 클릭하여 선택한 다음, 아래 키를 사용하여 로봇의 방향을 제어할 수 있습니다.

* ⬆️: 앞으로 이동
* ⬇️: 로봇 정지
* ⬅️: 왼쪽으로 이동
* ➡️: 오른쪽으로 이동

### 4. Batch Job 수행 완료된 결과 모델(각 컨테이너 노드로 마운트된 efs의 최종 결과물) 로 IsaacSim 실행 

```bash
./isaaclab.sh -p scripts/reinforcement_learning/skrl/play.py ​--task=Isaac-Velocity-Rough-H1-v0 --num_envs 25  --checkpoint=/workspace/IsaacLab/TrainedModel/models/h1_rough/2026-02-10_14-59-27_ppo_torch/checkpoints/best_agent.pt​

```

checkpoint 지정 시 디렉토리 유의해야 하며 docker file 내에 마운트될 때 /workspace/IsaacLab/TrainedModel 아래 마운트 되서 models/h1_rough/<date time _ppo_torch/checkpoints/best_agent.pt 형태로 job 완료시 모델이 저장되는 경로를 지정해야 합니다. 

​

{% hint style="success" %}
워크샵을 모두 수행했습니다! \
탄력적이고 확장 가능한 클라우드 인프라를 활용해, 병렬로 휴머노이드 로봇을 강화학습 하는 작업을 가속화 할 수 있습니다.
{% endhint %}
